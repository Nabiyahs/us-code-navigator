{
  "$id": "urn:us-code-navigator:schema-meta:v1",
  "tables": {
    "CodeType": {
      "pk": ["CodeTypeID"],
      "columns": {
        "CodeTypeID": { "type": "string", "nullable": false },
        "CodeTypeName": { "type": "string", "nullable": false },
        "Description": { "type": "string", "nullable": true }
      },
      "fks": []
    },
    "ModelCode": {
      "pk": ["ModelCodeID"],
      "columns": {
        "ModelCodeID": { "type": "string", "nullable": false },
        "CodeTypeID": { "type": "string", "nullable": false },
        "ModelCodeName": { "type": "string", "nullable": false },
        "Description": { "type": "string", "nullable": true }
      },
      "fks": [
        { "columns": ["CodeTypeID"], "ref": { "table": "CodeType", "columns": ["CodeTypeID"] }, "onDelete": "RESTRICT" }
      ]
    },
    "ModelCodeVersion": {
      "pk": ["ModelCodeVersionID"],
      "columns": {
        "ModelCodeVersionID": { "type": "string", "nullable": false },
        "ModelCodeID": { "type": "string", "nullable": false },
        "Year": { "type": "number", "nullable": true },
        "Description": { "type": "string", "nullable": true }
      },
      "fks": [
        { "columns": ["ModelCodeID"], "ref": { "table": "ModelCode", "columns": ["ModelCodeID"] }, "onDelete": "RESTRICT" }
      ],
      "derivedKeys": {
        "HumanKey": { "format": "ModelCodeName Year" }
      }
    },
    "Jurisdiction": {
      "pk": ["JurisdictionID"],
      "columns": {
        "JurisdictionID": { "type": "string", "nullable": false },
        "JurisdictionName": { "type": "string", "nullable": false },
        "StateName": { "type": "string", "nullable": false },
        "StateCode": { "type": "string", "nullable": false }
      },
      "fks": []
    },
    "Discipline": {
      "pk": ["DisciplineID"],
      "columns": {
        "DisciplineID": { "type": "string", "nullable": false },
        "DisciplineNameEN": { "type": "string", "nullable": false },
        "DisciplineNameKR": { "type": "string", "nullable": false }
      },
      "fks": []
    },
    "ModelCodeDiscipline": {
      "pk": ["ModelCodeID", "DisciplineID"],
      "columns": {
        "ModelCodeID": { "type": "string", "nullable": false },
        "DisciplineID": { "type": "string", "nullable": false },
        "ModelCodeName": { "type": "string", "nullable": false }
      },
      "fks": [
        { "columns": ["ModelCodeID"], "ref": { "table": "ModelCode", "columns": ["ModelCodeID"] }, "onDelete": "CASCADE" },
        { "columns": ["DisciplineID"], "ref": { "table": "Discipline", "columns": ["DisciplineID"] }, "onDelete": "CASCADE" }
      ]
    },
    "CodeChapter": {
      "pk": ["ChapterID"],
      "columns": {
        "ChapterID": { "type": "string", "nullable": false },
        "ModelCodeVersionID": { "type": "string", "nullable": false },
        "TitleEN": { "type": "string", "nullable": false },
        "TitleKR": { "type": "string", "nullable": false },
        "ChapterComment": { "type": "string", "nullable": true }
      },
      "fks": [
        { "columns": ["ModelCodeVersionID"], "ref": { "table": "ModelCodeVersion", "columns": ["ModelCodeVersionID"] }, "onDelete": "CASCADE" }
      ],
      "derivedKeys": {
        "ChapterKey": { "format": "ModelCodeName Year: Chapter {Chapter}" }
      }
    },
    "CodeContent": {
      "pk": ["ContentID"],
      "columns": {
        "ContentID": { "type": "string", "nullable": false },
        "CodeTypeID": { "type": "string", "nullable": false },
        "ModelCodeID": { "type": "string", "nullable": false },
        "ModelCodeVersionID": { "type": "string", "nullable": false },
        "JurisdictionID": { "type": "string", "nullable": true },
        "ChapterID": { "type": "string", "nullable": true },
        "Chapter": { "type": "string", "nullable": false },
        "Section": { "type": "string", "nullable": true },
        "Subsection": { "type": "string", "nullable": true },
        "TitleEN": { "type": "string", "nullable": true },
        "TitleKR": { "type": "string", "nullable": true },
        "ContentEN": { "type": "string", "nullable": true },
        "ContentKR": { "type": "string", "nullable": true },
        "Comment": { "type": "string", "nullable": true },
        "Index": { "type": "string", "nullable": true },
        "Subindex": { "type": "string", "nullable": true },
        "OrderKey": { "type": "string", "nullable": true }
      },
      "fks": [
        { "columns": ["CodeTypeID"], "ref": { "table": "CodeType", "columns": ["CodeTypeID"] }, "onDelete": "RESTRICT" },
        { "columns": ["ModelCodeID"], "ref": { "table": "ModelCode", "columns": ["ModelCodeID"] }, "onDelete": "RESTRICT" },
        { "columns": ["ModelCodeVersionID"], "ref": { "table": "ModelCodeVersion", "columns": ["ModelCodeVersionID"] }, "onDelete": "CASCADE" },
        { "columns": ["JurisdictionID"], "ref": { "table": "Jurisdiction", "columns": ["JurisdictionID"] }, "onDelete": "SET_NULL" },
        { "columns": ["ChapterID"], "ref": { "table": "CodeChapter", "columns": ["ChapterID"] }, "onDelete": "CASCADE" }
      ],
      "derivedKeys": {
        "ContentKey": { "format": "ModelCodeName Year: Chapter {Chapter} - Section {Section}[.{Subsection}]" },
        "PlaceKey": { "format": "ModelCodeVersionID:Chapter:Section[:Subsection]" }
      },
      "indexes": [
        { "name": "byPlace", "columns": ["ModelCodeVersionID", "Chapter", "Section", "Subsection"] },
        { "name": "byOrder", "columns": ["OrderKey"] },
        { "name": "byIndex", "columns": ["Index"] },
        { "name": "bySubindex", "columns": ["Subindex"] }
      ]
    },
    "CodeAttachment": {
      "pk": ["AttachmentID"],
      "columns": {
        "AttachmentID": { "type": "string", "nullable": false },
        "ModelCodeVersionID": { "type": "string", "nullable": false },
        "Type": { "type": "string", "nullable": false },
        "Number": { "type": "string", "nullable": true },
        "FileName": { "type": "string", "nullable": false },
        "Chapter": { "type": "string", "nullable": false },
        "Section": { "type": "string", "nullable": false },
        "Subsection": { "type": "string", "nullable": true },
        "AttachTitleEN": { "type": "string", "nullable": true },
        "AttachTitleKR": { "type": "string", "nullable": true },
        "AttachContentEN": { "type": "string", "nullable": true },
        "AttachContentKR": { "type": "string", "nullable": true },
        "AttachComment": { "type": "string", "nullable": true }
      },
      "fks": [
        {
          "columns": ["ModelCodeVersionID", "Chapter", "Section", "Subsection"],
          "ref": { "table": "CodeContent", "columns": ["ModelCodeVersionID", "Chapter", "Section", "Subsection"] },
          "onDelete": "CASCADE"
        }
      ],
      "derivedKeys": {
        "PlaceKey": { "format": "ModelCodeVersionID:Chapter:Section[:Subsection]" },
        "AttachKey": { "format": "ModelCodeVersionID:Chapter:Section[:Subsection]:{Type}:{Number}" }
      },
      "indexes": [
        { "name": "byPlace", "columns": ["ModelCodeVersionID", "Chapter", "Section", "Subsection"] },
        { "name": "byType", "columns": ["Type"] },
        { "name": "byNumber", "columns": ["Number"] },
        { "name": "byFile", "columns": ["FileName"] }
        ]
      }
  },
  "relationships": [
    { "fromColumns": ["ModelCode.CodeTypeID"], "toColumns": ["CodeType.CodeTypeID"], "cardinality": "N:1" },
    { "fromColumns": ["ModelCodeVersion.ModelCodeID"], "toColumns": ["ModelCode.ModelCodeID"], "cardinality": "N:1" },
    { "fromColumns": ["CodeChapter.ModelCodeVersionID"], "toColumns": ["ModelCodeVersion.ModelCodeVersionID"], "cardinality": "N:1" },
    { "fromColumns": ["CodeContent.ChapterID"], "toColumns": ["CodeChapter.ChapterID"], "cardinality": "N:1" },
    { "fromColumns": ["CodeContent.JurisdictionID"], "toColumns": ["Jurisdiction.JurisdictionID"], "cardinality": "N:1(optional)" },
    { "fromColumns": ["CodeContent.CodeTypeID"], "toColumns": ["CodeType.CodeTypeID"], "cardinality": "N:1" },
    { "fromColumns": ["CodeContent.ModelCodeID"], "toColumns": ["ModelCode.ModelCodeID"], "cardinality": "N:1" },
    { "fromColumns": ["CodeContent.ModelCodeVersionID"], "toColumns": ["ModelCodeVersion.ModelCodeVersionID"], "cardinality": "N:1" },
    {
      "fromColumns": [
        "CodeAttachment.ModelCodeVersionID",
        "CodeAttachment.Chapter",
        "CodeAttachment.Section",
        "CodeAttachment.Subsection"
      ],
      "toColumns": [
        "CodeContent.ModelCodeVersionID",
        "CodeContent.Chapter",
        "CodeContent.Section",
        "CodeContent.Subsection"
      ],
      "cardinality": "N:1"
    },
    { "fromColumns": ["ModelCodeDiscipline.ModelCodeID"], "toColumns": ["ModelCode.ModelCodeID"], "cardinality": "N:1" },
    { "fromColumns": ["ModelCodeDiscipline.DisciplineID"], "toColumns": ["Discipline.DisciplineID"], "cardinality": "N:1" }
  ]
}
